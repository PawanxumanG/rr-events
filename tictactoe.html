<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tic Tac Toe ‚Äì RR Events</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- GOOGLE ANALYTICS -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9JW1V42V83"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9JW1V42V83', {
  page_title: 'Tic Tac Toe',
  page_path: '/tictactoe.html'
});
gtag('event', 'game_open', {event_category:'TicTacToe'});
</script>

<style>
body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    background: #0f1117;
    color: #fff;
    text-align: center;
}

.header {
    padding: 16px;
    background: linear-gradient(90deg, #6a11cb, #2575fc);
    position: relative;
}

.ai-toggle {
    position: absolute;
    right: 12px;
    top: 12px;
    background: rgba(0,0,0,0.3);
    border: none;
    border-radius: 20px;
    padding: 6px 12px;
    color: #fff;
    font-size: 13px;
    cursor: pointer;
}

.status {
    margin-top: 12px;
    font-size: 18px;
    font-weight: 600;
}

.board {
    display: grid;
    grid-template-columns: repeat(3, 95px);
    gap: 12px;
    justify-content: center;
    margin: 30px auto;
}

.cell {
    width: 95px;
    height: 95px;
    background: #161a22;
    border-radius: 16px;
    font-size: 46px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}

.cell.x {
    color: #4fc3ff;
    text-shadow: 0 0 14px rgba(79,195,255,0.8);
}

.cell.o {
    color: #ff9800;
    text-shadow: 0 0 14px rgba(255,152,0,0.8);
}

button {
    width: 80%;
    max-width: 260px;
    padding: 14px;
    border-radius: 14px;
    border: none;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    margin-top: 14px;
}

.restart {
    background: linear-gradient(90deg, #ff9800, #ff6a00);
}

.back {
    background: #34495e;
    color: #fff;
}
</style>
</head>

<body>

<div class="header">
    <h2>üéÆ Tic Tac Toe</h2>
    <p>Play & Chill</p>

    <button class="ai-toggle" onclick="toggleAI()">
        ü§ñ <span id="aiText">Play with AI</span>
    </button>
</div>

<div class="status" id="status">Player X's Turn</div>

<div class="board" id="board"></div>

<button class="restart" onclick="restartGame()">üîÅ Restart Game</button>
<button class="back" onclick="location.href='index.html'">‚¨Ö Back to Home</button>

<script>
let board = ["","","","","","","","",""];
let currentPlayer = "X";
let gameActive = true;
let vsAI = false;

const statusDiv = document.getElementById("status");
const boardDiv = document.getElementById("board");
const aiText = document.getElementById("aiText");

const winPatterns = [
 [0,1,2],[3,4,5],[6,7,8],
 [0,3,6],[1,4,7],[2,5,8],
 [0,4,8],[2,4,6]
];

function toggleAI() {
    vsAI = !vsAI;
    aiText.innerText = vsAI ? "Play with Friend" : "Play with AI";
    gtag('event','ai_mode_toggle',{enabled:vsAI});
    restartGame();
}

function drawBoard() {
    boardDiv.innerHTML = "";
    board.forEach((v,i)=>{
        const c=document.createElement("div");
        c.className="cell";
        if(v==="X") c.classList.add("x");
        if(v==="O") c.classList.add("o");
        c.innerText=v;
        c.onclick=()=>makeMove(i);
        boardDiv.appendChild(c);
    });
}

function makeMove(i) {
    if(!gameActive||board[i]) return;
    board[i]=currentPlayer;
    if(checkWin()) return endGame(currentPlayer);
    if(board.every(v=>v)) return endDraw();
    currentPlayer = currentPlayer==="X"?"O":"X";
    updateStatus();

    if(vsAI && currentPlayer==="O"){
        setTimeout(aiMove,400);
    }
}

function aiMove(){
    let move = findBestMove();
    board[move]="O";
    gtag('event','ai_move',{cell:move});
    if(checkWin()) return endGame("O",true);
    if(board.every(v=>v)) return endDraw();
    currentPlayer="X";
    updateStatus();
    drawBoard();
}

function findBestMove(){
    for(let i=0;i<9;i++){
        if(!board[i]){
            board[i]="O";
            if(checkWin()){board[i]="";return i;}
            board[i]="";
        }
    }
    for(let i=0;i<9;i++){
        if(!board[i]){
            board[i]="X";
            if(checkWin()){board[i]="";return i;}
            board[i]="";
        }
    }
    return board.findIndex(v=>v==="");
}

function checkWin(){
    return winPatterns.some(p =>
      board[p[0]] &&
      board[p[0]]===board[p[1]] &&
      board[p[1]]===board[p[2]]
    );
}

function endGame(player, ai=false){
    gameActive=false;
    statusDiv.innerHTML = ai && player==="O"
      ? "ü§ñ AI Wins!"
      : `üéâ Player ${player} Wins!`;

    gtag('event','game_win',{
      winner: ai?"AI":"Human",
      symbol: player
    });
    drawBoard();
}

function endDraw(){
    gameActive=false;
    statusDiv.innerText="ü§ù Match Draw";
    gtag('event','game_draw');
}

function updateStatus(){
    statusDiv.innerText =
      vsAI && currentPlayer==="O"
      ? "ü§ñ AI Thinking..."
      : `Player ${currentPlayer}'s Turn`;
    drawBoard();
}

function restartGame(){
    board=["","","","","","","","",""];
    currentPlayer="X";
    gameActive=true;
    updateStatus();
}
drawBoard();
</script>

</body>
</html>