<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tic Tac Toe ‚Äì RR Events App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- GOOGLE ANALYTICS -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9JW1V42V83"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9JW1V42V83');
</script>

<style>
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
body{
    margin:0;
    font-family:'Segoe UI',Arial,sans-serif;
    background:#0f1117;
    color:#fff;
    text-align:center;
}

/* HEADER */
.game-header{
    background:linear-gradient(90deg,#6a11cb,#2575fc);
    padding:26px 12px;
}
.game-header h1{margin:0;font-size:28px;}
.game-header p{margin:6px 0 14px;opacity:.9;}

/* MODE + TOGGLES */
.controls{
    display:flex;
    justify-content:center;
    gap:12px;
    flex-wrap:wrap;
}

.mode-btn,.toggle-btn{
    background:rgba(0,0,0,.35);
    border:none;
    border-radius:26px;
    padding:10px 18px;
    color:#fff;
    font-size:14px;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:6px;
}

/* SCOREBOARD */
.scoreboard{
    display:flex;
    justify-content:center;
    gap:14px;
    margin:16px 0;
    font-size:14px;
}
.score{
    background:#161a22;
    padding:10px 14px;
    border-radius:10px;
}

/* STATUS */
.status{margin:16px 0;font-size:18px;font-weight:600;}

/* BOARD */
.board{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:14px;
    max-width:320px;
    margin:0 auto;
}
.cell{
    background:#161a22;
    border-radius:16px;
    height:90px;
    font-size:42px;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    box-shadow:0 6px 18px rgba(0,0,0,.6);
    transition:transform .15s ease;
}
.cell:active{transform:scale(.92);}
.cell.X{color:#4fc3f7;}
.cell.O{color:#ffb74d;}

/* üî• WIN GLOW */
.cell.win{
    animation:glow 1s infinite alternate;
    background:linear-gradient(135deg,#ff512f,#dd2476);
}
@keyframes glow{
    from{box-shadow:0 0 12px rgba(255,81,47,.5);}
    to{box-shadow:0 0 28px rgba(255,81,47,1);}
}

/* BUTTONS */
.btn{
    width:80%;
    max-width:280px;
    padding:14px;
    font-size:16px;
    font-weight:600;
    border:none;
    border-radius:12px;
    cursor:pointer;
    margin-top:16px;
    color:#ffffff;
    transition:transform .15s ease;
}
.btn:active{transform:scale(.95);}
.btn-restart{
    background:linear-gradient(90deg,#ff9800,#ff6a00);
}
.btn-back{
    background:#34495e;
}
</style>
</head>

<body>

<div class="game-header">
    <h1>üéÆ Tic Tac Toe</h1>
    <p>Play & Chill</p>

    <div class="controls">
        <button class="mode-btn" onclick="toggleMode()">
            <span id="modeIcon">üë•</span>
            <span id="modeText">Friend</span>
        </button>

        <button class="toggle-btn" onclick="toggleSound()">
            üîä <span id="soundText">Sound On</span>
        </button>

        <button class="toggle-btn" onclick="toggleVibration()">
            üì≥ <span id="vibrateText">Vibration On</span>
        </button>
    </div>
</div>

<div class="scoreboard">
    <div class="score">‚ùå X: <span id="xScore">0</span></div>
    <div class="score">‚≠ï O: <span id="oScore">0</span></div>
    <div class="score">ü§ù Draw: <span id="drawScore">0</span></div>
</div>

<div class="status" id="status">Player X Turn</div>
<div class="board" id="board"></div>

<button class="btn btn-restart" onclick="restartGame()">üîÅ Restart Game</button>
<button class="btn btn-back" onclick="location.href='index.html'">‚¨Ö Back to Home</button>

<!-- üîä SOUNDS -->
<audio id="clickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3"></audio>
<audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

<script>
const boardEl=document.getElementById("board");
const statusEl=document.getElementById("status");
const modeIcon=document.getElementById("modeIcon");
const modeText=document.getElementById("modeText");

let board,currentPlayer,gameOver,vsAI=true;
let soundOn=true,vibrationOn=true;

let scores={
    X:+localStorage.getItem("xScore")||0,
    O:+localStorage.getItem("oScore")||0,
    D:+localStorage.getItem("drawScore")||0
};

xScore.innerText=scores.X;
oScore.innerText=scores.O;
drawScore.innerText=scores.D;

const wins=[
[0,1,2],[3,4,5],[6,7,8],
[0,3,6],[1,4,7],[2,5,8],
[0,4,8],[2,4,6]
];

function init(){
    board=Array(9).fill("");
    currentPlayer="X";
    gameOver=false;
    statusEl.innerText="Player X Turn";
    boardEl.innerHTML="";
    board.forEach((_,i)=>{
        const c=document.createElement("div");
        c.className="cell";
        c.onclick=()=>move(i);
        boardEl.appendChild(c);
    });
}
init();

function move(i){
    if(board[i]||gameOver)return;
    board[i]=currentPlayer;
    playClick();
    vibrate(20);
    render();

    let winLine=getWinLine(currentPlayer);
    if(winLine){
        winLine.forEach(i=>boardEl.children[i].classList.add("win"));
        statusEl.innerText=`üéâ Player ${currentPlayer} Wins!`;
        scores[currentPlayer]++;
        saveScores();
        playWin();
        vibrate(200);
        gameOver=true;return;
    }

    if(board.every(v=>v)){
        statusEl.innerText="ü§ù Match Draw";
        scores.D++;
        saveScores();
        gameOver=true;return;
    }

    currentPlayer=currentPlayer==="X"?"O":"X";
    statusEl.innerText=`Player ${currentPlayer} Turn`;

    if(vsAI && currentPlayer==="O"){
        setTimeout(()=>move(bestMove()),350);
    }
}

/* üß† UNBEATABLE AI */
function bestMove(){
    let best=-Infinity,move;
    board.forEach((v,i)=>{
        if(v===""){
            board[i]="O";
            let score=minimax(board,0,false);
            board[i]="";
            if(score>best){best=score;move=i;}
        }
    });
    return move;
}

function minimax(b,d,isMax){
    let res=checkResult();
    if(res!==null)return res==="O"?10-d:res==="X"?d-10:0;
    let best=isMax?-Infinity:Infinity;
    b.forEach((v,i)=>{
        if(v===""){
            b[i]=isMax?"O":"X";
            let val=minimax(b,d+1,!isMax);
            b[i]="";
            best=isMax?Math.max(best,val):Math.min(best,val);
        }
    });
    return best;
}

function checkResult(){
    for(let w of wins){
        let[a,b,c]=w;
        if(board[a]&&board[a]===board[b]&&board[a]===board[c])return board[a];
    }
    return board.includes("")?null:"draw";
}

function getWinLine(p){return wins.find(w=>w.every(i=>board[i]===p));}

function render(){
    [...boardEl.children].forEach((c,i)=>{
        c.innerText=board[i];
        c.className="cell "+board[i];
    });
}

function saveScores(){
    localStorage.setItem("xScore",scores.X);
    localStorage.setItem("oScore",scores.O);
    localStorage.setItem("drawScore",scores.D);
    xScore.innerText=scores.X;
    oScore.innerText=scores.O;
    drawScore.innerText=scores.D;
}

function restartGame(){init();}

function toggleMode(){
    vsAI=!vsAI;
    modeIcon.innerText=vsAI?"üë•":"ü§ñ";
    modeText.innerText=vsAI?"Friend":"RR AI Bot";
    restartGame();
}

function toggleSound(){
    soundOn=!soundOn;
    soundText.innerText=soundOn?"Sound On":"Sound Off";
}

function toggleVibration(){
    vibrationOn=!vibrationOn;
    vibrateText.innerText=vibrationOn?"Vibration On":"Vibration Off";
}

function playClick(){if(soundOn)clickSound.play();}
function playWin(){if(soundOn)winSound.play();}
function vibrate(ms){if(vibrationOn && navigator.vibrate)navigator.vibrate(ms);}
</script>

</body>
</html>